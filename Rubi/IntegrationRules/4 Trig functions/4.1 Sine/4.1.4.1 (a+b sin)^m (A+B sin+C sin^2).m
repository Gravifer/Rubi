
(* ::Subsection::Closed:: *)
(* 4.1.4.1 (a+b sin)^m (A+B sin+C sin^2) *)
Int[(b_.*sin[e_. + f_.*x_])^ m_.*(B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["4f1315d6"]] := 1/b*Int[(b*Sin[e + f*x])^(m + 1)*(B + C*Sin[e + f*x]), x] /; FreeQ[{b, e, f, B, C, m}, x]
Int[(b_.*sin[e_. + f_.*x_])^m_.*(A_ + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["4d55ab8f"]] := A*Cos[e + f*x]*(b*Sin[e + f*x])^(m + 1)/(b*f*(m + 1)) /; FreeQ[{b, e, f, A, C, m}, x] && EqQ[A*(m + 2) + C*(m + 1), 0]
Int[(b_.*sin[e_. + f_.*x_])^m_*(A_ + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["4c97c1b8"]] := A*Cos[e + f*x]*(b*Sin[e + f*x])^(m + 1)/(b*f*(m + 1)) + (A*(m + 2) + C*(m + 1))/(b^2*(m + 1))*Int[(b*Sin[e + f*x])^(m + 2), x] /; FreeQ[{b, e, f, A, C}, x] && LtQ[m, -1]
Int[sin[e_. + f_.*x_]^m_.*(A_ + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["49d8d73d"]] := -1/f* Subst[Int[(1 - x^2)^((m - 1)/2)*(A + C - C*x^2), x], x, Cos[e + f*x]] /; FreeQ[{e, f, A, C}, x] && IGtQ[(m + 1)/2, 0]
Int[(b_.*sin[e_. + f_.*x_])^m_.*(A_ + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["481abd0a"]] := -C* Cos[e + f*x]*(b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2)) + (A*(m + 2) + C*(m + 1))/(m + 2)*Int[(b*Sin[e + f*x])^m, x] /; FreeQ[{b, e, f, A, C, m}, x] && Not[LtQ[m, -1]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["4a5c0353"]] := 1/b^2*Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[b*B - a*C + b*C*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[A*b^2 - a*b*B + a^2*C, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["4b9e6964"]] := C/b^2*Int[(a + b*Sin[e + f*x])^(m + 1)*Simp[-a + b*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A*b^2 + a^2*C, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^ m_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["40c22e59"]] := (A - C)* Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x]), x] + C*Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x])^2, x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && EqQ[A - B + C, 0] && Not[IntegerQ[2*m]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["4100446e"]] := (A - C)* Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x]), x] + C*Int[(a + b*Sin[e + f*x])^m*(1 + Sin[e + f*x])^2, x] /; FreeQ[{a, b, e, f, A, C, m}, x] && EqQ[A + C, 0] && Not[IntegerQ[2*m]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^ m_*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["e828fe43"]] := (A*b - a*B + b*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^m/(a*f*(2*m + 1)) + 1/(a^2*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[a*A*(m + 1) + m*(b*B - a*C) + b*C*(2*m + 1)*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && LtQ[m, -1] && EqQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["e9ea9474"]] := b*(A + C)*Cos[e + f*x]*(a + b*Sin[e + f*x])^m/(a*f*(2*m + 1)) + 1/(a^2*(2*m + 1))* Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[a*A*(m + 1) - a*C*m + b*C*(2*m + 1)*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && LtQ[m, -1] && EqQ[a^2 - b^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["ebac2a2d"]] := -(A*b^2 - a*b*B + a^2*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b* f*(m + 1)*(a^2 - b^2)) + 1/(b*(m + 1)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[b*(a*A - b*B + a*C)*(m + 1) - (A*b^2 - a*b*B + a^2*C + b*(A*b - a*B + b*C)*(m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C}, x] && LtQ[m, -1] && NeQ[a^2 - b^2, 0]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["ea6e401a"]] := -(A*b^2 + a^2*C)* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b* f*(m + 1)*(a^2 - b^2)) + 1/(b*(m + 1)*(a^2 - b^2))* Int[(a + b*Sin[e + f*x])^(m + 1)* Simp[a*b*(A + C)*(m + 1) - (A*b^2 + a^2*C + b^2*(A + C)*(m + 1))*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C}, x] && LtQ[m, -1] && NeQ[a^2 - b^2, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_])^ m_.*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["ef21569f"]] := -C* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[(a + b*Sin[e + f*x])^m* Simp[A*b*(m + 2) + b*C*(m + 1) + (b*B*(m + 2) - a*C)*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, B, C, m}, x] && Not[LtQ[m, -1]]
Int[(a_ + b_.*sin[e_. + f_.*x_])^m_.*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["eee33ca8"]] := -C* Cos[e + f*x]*(a + b*Sin[e + f*x])^(m + 1)/(b*f*(m + 2)) + 1/(b*(m + 2))* Int[(a + b*Sin[e + f*x])^m* Simp[A*b*(m + 2) + b*C*(m + 1) - a*C*Sin[e + f*x], x], x] /; FreeQ[{a, b, e, f, A, C, m}, x] && Not[LtQ[m, -1]]
Int[(b_.*sin[e_. + f_.*x_]^p_)^ m_*(A_. + B_.*sin[e_. + f_.*x_] + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["eca582f1"]] := (b*Sin[e + f*x]^p)^m/(b*Sin[e + f*x])^(m*p)* Int[(b*Sin[e + f*x])^(m*p)*(A + B*Sin[e + f*x] + C*Sin[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m, p}, x] && Not[IntegerQ[m]]
Int[(b_.*cos[e_. + f_.*x_]^p_)^ m_*(A_. + B_.*cos[e_. + f_.*x_] + C_.*cos[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["ed67e8c6"]] := (b*Cos[e + f*x]^p)^m/(b*Cos[e + f*x])^(m*p)* Int[(b*Cos[e + f*x])^(m*p)*(A + B*Cos[e + f*x] + C*Cos[e + f*x]^2), x] /; FreeQ[{b, e, f, A, B, C, m, p}, x] && Not[IntegerQ[m]]
Int[(b_.*sin[e_. + f_.*x_]^p_)^m_*(A_. + C_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["e63baffb"]] := (b*Sin[e + f*x]^p)^m/(b*Sin[e + f*x])^(m*p)* Int[(b*Sin[e + f*x])^(m*p)*(A + C*Sin[e + f*x]^2), x] /; FreeQ[{b, e, f, A, C, m, p}, x] && Not[IntegerQ[m]]
Int[(b_.*cos[e_. + f_.*x_]^p_)^m_*(A_. + C_.*cos[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["e7f9c5cc"]] := (b*Cos[e + f*x]^p)^m/(b*Cos[e + f*x])^(m*p)* Int[(b*Cos[e + f*x])^(m*p)*(A + C*Cos[e + f*x]^2), x] /; FreeQ[{b, e, f, A, C, m, p}, x] && Not[IntegerQ[m]]
