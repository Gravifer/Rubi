
(* ::Subsection::Closed:: *)
(* 4.1.7 (d trig)^m (a+b (c sin)^n)^p *)
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)*(A_. + B_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["f20e0ac5"]] := (4*A*(2*a + b) + B*(4*a + 3*b))*x/8 - (4*A*b + B*(4*a + 3*b))*Cos[e + f*x]*Sin[e + f*x]/(8*f) - b*B*Cos[e + f*x]*Sin[e + f*x]^3/(4*f) /; FreeQ[{a, b, e, f, A, B}, x]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^p_*(A_. + B_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["f048b49c"]] := -B*Cos[e + f*x]* Sin[e + f*x]*(a + b*Sin[e + f*x]^2)^p/(2*f*(p + 1)) + 1/(2*(p + 1))*Int[(a + b*Sin[e + f*x]^2)^(p - 1)* Simp[a*B + 2*a*A*(p + 1) + (2*A*b*(p + 1) + B*(b + 2*a*p + 2*b*p))* Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B}, x] && GtQ[p, 0]
Int[(A_. + B_.*sin[e_. + f_.*x_]^2)/(a_ + b_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["f18adeab"]] := B*x/b + (A*b - a*B)/b*Int[1/(a + b*Sin[e + f*x]^2), x] /; FreeQ[{a, b, e, f, A, B}, x]
Int[(A_. + B_.*sin[e_. + f_.*x_]^2)/ Sqrt[a_ + b_.*sin[e_. + f_.*x_]^2], x_Symbol, _:RubiNotebookReference["f4c5c82e"]] := B/b*Int[Sqrt[a + b*Sin[e + f*x]^2], x] + (A*b - a*B)/b* Int[1/Sqrt[a + b*Sin[e + f*x]^2], x] /; FreeQ[{a, b, e, f, A, B}, x]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^p_*(A_. + B_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["f507a219"]] := -(A*b - a*B)*Cos[e + f*x]* Sin[e + f*x]*(a + b*Sin[e + f*x]^2)^(p + 1)/(2*a* f*(a + b)*(p + 1)) - 1/(2*a*(a + b)*(p + 1))*Int[(a + b*Sin[e + f*x]^2)^(p + 1)* Simp[a*B - A*(2*a*(p + 1) + b*(2*p + 3)) + 2*(A*b - a*B)*(p + 2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f, A, B}, x] && LtQ[p, -1] && NeQ[a + b, 0]
Int[(a_. + b_.*sin[e_. + f_.*x_]^2)^ p_*(A_. + B_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["f7411c40"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(a + b*Sin[e + f*x]^2)^ p*(Sec[e + f*x]^2)^p/(f*(a + (a + b)*Tan[e + f*x]^2)^p)* Subst[ Int[(a + (a + b)*ff^2*x^2)^ p*(A + (A + B)*ff^2*x^2)/(1 + ff^2*x^2)^(p + 2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, A, B}, x] && Not[IntegerQ[p]]
Int[u_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol, _:RubiNotebookReference["f6837677"]] := a^p*Int[ActivateTrig[u*cos[e + f*x]^(2*p)], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a + b, 0] && IntegerQ[p]
Int[u_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol, _:RubiNotebookReference["fddf314a"]] := Int[ActivateTrig[u*(a*cos[e + f*x]^2)^p], x] /; FreeQ[{a, b, e, f, p}, x] && EqQ[a + b, 0]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]^2], x_Symbol, _:RubiNotebookReference["fc1d5b7d"]] := Sqrt[a]/f*EllipticE[e + f*x, -b/a] /; FreeQ[{a, b, e, f}, x] && GtQ[a, 0]
Int[Sqrt[a_ + b_.*sin[e_. + f_.*x_]^2], x_Symbol, _:RubiNotebookReference["6c2ba282"]] := Sqrt[a + b*Sin[e + f*x]^2]/Sqrt[1 + b*Sin[e + f*x]^2/a]* Int[Sqrt[1 + (b*Sin[e + f*x]^2)/a], x] /; FreeQ[{a, b, e, f}, x] && Not[GtQ[a, 0]]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^2, x_Symbol, _:RubiNotebookReference["6de9c8b5"]] := (8*a^2 + 8*a*b + 3*b^2)*x/8 - b*(8*a + 3*b)*Cos[e + f*x]*Sin[e + f*x]/(8*f) - b^2*Cos[e + f*x]*Sin[e + f*x]^3/(4*f) /; FreeQ[{a, b, e, f}, x]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol, _:RubiNotebookReference["6faf76ec"]] := -b*Cos[e + f*x]* Sin[e + f*x]*(a + b*Sin[e + f*x]^2)^(p - 1)/(2*f*p) + 1/(2*p)* Int[(a + b*Sin[e + f*x]^2)^(p - 2)* Simp[a*(b + 2*a*p) + b*(2*a + b)*(2*p - 1)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a + b, 0] && GtQ[p, 1]
Int[1/(a_ + b_.*sin[e_. + f_.*x_]^2), x_Symbol, _:RubiNotebookReference["6e6d1cdb"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[1/(a + (a + b)*ff^2*x^2), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x]
Int[1/Sqrt[a_ + b_.*sin[e_. + f_.*x_]^2], x_Symbol, _:RubiNotebookReference["6b220a5e"]] := 1/(Sqrt[a]*f)*EllipticF[e + f*x, -b/a] /; FreeQ[{a, b, e, f}, x] && GtQ[a, 0]
Int[1/Sqrt[a_ + b_.*sin[e_. + f_.*x_]^2], x_Symbol, _:RubiNotebookReference["6ae06069"]] := Sqrt[1 + b*Sin[e + f*x]^2/a]/Sqrt[a + b*Sin[e + f*x]^2]* Int[1/Sqrt[1 + (b*Sin[e + f*x]^2)/a], x] /; FreeQ[{a, b, e, f}, x] && Not[GtQ[a, 0]]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol, _:RubiNotebookReference["68a6de30"]] := -b*Cos[e + f*x]* Sin[e + f*x]*(a + b*Sin[e + f*x]^2)^(p + 1)/(2*a* f*(p + 1)*(a + b)) + 1/(2*a*(p + 1)*(a + b))* Int[(a + b*Sin[e + f*x]^2)^(p + 1)* Simp[2*a*(p + 1) + b*(2*p + 3) - 2*b*(p + 2)*Sin[e + f*x]^2, x], x] /; FreeQ[{a, b, e, f}, x] && NeQ[a + b, 0] && LtQ[p, -1]
Int[(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["6964b407"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x])* Subst[Int[(a + b*ff^2*x^2)^p/Sqrt[1 - ff^2*x^2], x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && Not[IntegerQ[p]]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["6238f33a"]] := With[{ff = FreeFactors[Cos[e + f*x], x]}, -ff/f* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b - b*ff^2*x^2)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["63fa990d"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[ x^m*(a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^(m/2 + p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["7e9e0d6c"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff^(m + 1)*Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x])* Subst[Int[x^m*(a + b*ff^2*x^2)^p/Sqrt[1 - ff^2*x^2], x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && Not[IntegerQ[p]]
Int[(d_.*sin[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["7f5c675b"]] := With[{ff = FreeFactors[Cos[e + f*x], x]}, -ff*d^(2*IntPart[(m - 1)/2] + 1)*(d*Sin[e + f*x])^(2* FracPart[(m - 1)/2])/(f*(Sin[e + f*x]^2)^ FracPart[(m - 1)/2])* Subst[ Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b - b*ff^2*x^2)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] && Not[IntegerQ[m]]
Int[cos[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["7d1ad902"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff/f* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[cos[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["7cd8b335"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^(m/2 + p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[cos[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["7997a5b0"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x])* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && Not[IntegerQ[p]]
Int[(d_.*cos[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["7855cf87"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*d^(2*IntPart[(m - 1)/2] + 1)*(d*Cos[e + f*x])^(2* FracPart[(m - 1)/2])/(f*(Cos[e + f*x]^2)^ FracPart[(m - 1)/2])* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] && Not[IntegerQ[m]]
Int[tan[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["7a1371de"]] := With[{ff = FreeFactors[Sin[e + f*x]^2, x]}, ff^((m + 1)/2)/(2*f)* Subst[Int[x^((m - 1)/2)*(a + b*ff*x)^p/(1 - ff*x)^((m + 1)/2), x], x, Sin[e + f*x]^2/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[(d_.*tan[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["7bd11be9"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(d*ff*x)^ m*(a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^(p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[p]
Int[tan[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["708d5cd4"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff^(m + 1)*Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x])* Subst[ Int[x^m*(a + b*ff^2*x^2)^p/(1 - ff^2*x^2)^((m + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && Not[IntegerQ[p]]
Int[(d_.*tan[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["714f36e3"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*(d*Tan[e + f*x])^(m + 1)*(Cos[e + f*x]^2)^((m + 1)/2)/(d*f* Sin[e + f*x]^(m + 1))* Subst[ Int[(ff*x)^m*(a + b*ff^2*x^2)^p/(1 - ff^2*x^2)^((m + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m, p}, x] && Not[IntegerQ[m]]
Int[cos[e_. + f_.*x_]^m_.*(d_.*sin[e_. + f_.*x_])^ n_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["c6226a09"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff/f* Subst[Int[(d*ff*x)^n*(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^ p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, n, p}, x] && IntegerQ[(m - 1)/2]
Int[(c_.*sin[e_. + f_.*x_])^m_* sin[e_. + f_.*x_]^n_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["c7e0003e"]] := With[{ff = FreeFactors[Cos[e + f*x], x]}, -ff/f* Subst[Int[(c*ff*x)^ m*(1 - ff^2*x^2)^((n - 1)/2)*(a + b - b*ff^2*x^2)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, m, p}, x] && IntegerQ[(n - 1)/2]
Int[cos[e_. + f_.*x_]^m_* sin[e_. + f_.*x_]^n_*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["c5a6be67"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(n + 1)/f* Subst[Int[ x^n*(a + (a + b)*ff^2*x^2)^p/(1 + ff^2*x^2)^((m + n)/2 + p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[e_. + f_.*x_]^m_*(d_.*sin[e_. + f_.*x_])^ n_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["c464d450"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*Sqrt[Cos[e + f*x]^2]/(f*Cos[e + f*x])* Subst[Int[(d*ff*x)^n*(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^ p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, n, p}, x] && IntegerQ[m/2]
Int[(c_.*cos[e_. + f_.*x_])^m_*(d_.*sin[e_. + f_.*x_])^ n_.*(a_ + b_.*sin[e_. + f_.*x_]^2)^p_., x_Symbol, _:RubiNotebookReference["c12bc2d5"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff*c^(2*IntPart[(m - 1)/2] + 1)*(c*Cos[e + f*x])^(2* FracPart[(m - 1)/2])/(f*(Cos[e + f*x]^2)^ FracPart[(m - 1)/2])* Subst[ Int[(d*ff*x)^n*(1 - ff^2*x^2)^((m - 1)/2)*(a + b*ff^2*x^2)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[(b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol, _:RubiNotebookReference["c0e9a8e2"]] := -Cot[e + f*x]*(b*Sin[e + f*x]^2)^p/(2*f*p) + b*(2*p - 1)/(2*p)*Int[(b*Sin[e + f*x]^2)^(p - 1), x] /; FreeQ[{b, e, f}, x] && Not[IntegerQ[p]] && GtQ[p, 1]
Int[(b_.*sin[e_. + f_.*x_]^2)^p_, x_Symbol, _:RubiNotebookReference["c2af16bb"]] := Cot[e + f*x]*(b*Sin[e + f*x]^2)^(p + 1)/(b*f*(2*p + 1)) + 2*(p + 1)/(b*(2*p + 1))*Int[(b*Sin[e + f*x]^2)^(p + 1), x] /; FreeQ[{b, e, f}, x] && Not[IntegerQ[p]] && LtQ[p, -1]
Int[tan[e_. + f_.*x_]^m_.*(b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol, _:RubiNotebookReference["c36d7c8c"]] := With[{ff = FreeFactors[Sin[e + f*x]^2, x]}, ff^((m + 1)/2)/(2*f)* Subst[Int[ x^((m - 1)/2)*(b*ff^(n/2)*x^(n/2))^p/(1 - ff*x)^((m + 1)/2), x], x, Sin[e + f*x]^2/ff]] /; FreeQ[{b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2]
Int[tan[e_. + f_.*x_]^m_.*(b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_., x_Symbol, _:RubiNotebookReference["c8313bb1"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[x^m*(b*(c*ff*x)^n)^p/(1 - ff^2*x^2)^((m + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{b, c, e, f, n, p}, x] && ILtQ[(m - 1)/2, 0]
Int[u_.*(b_.*sin[e_. + f_.*x_]^n_)^p_, x_Symbol, _:RubiNotebookReference["c9f35186"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, (b*ff^n)^ IntPart[p]*(b*Sin[e + f*x]^n)^ FracPart[p]/(Sin[e + f*x]/ff)^(n*FracPart[p])* Int[ActivateTrig[u]*(Sin[e + f*x]/ff)^(n*p), x]] /; FreeQ[{b, e, f, n, p}, x] && Not[IntegerQ[p]] && IntegerQ[n] && (EqQ[u, 1] || MatchQ[u, (d_.*trig_[e + f*x])^m_. /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
Int[u_.*(b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_, x_Symbol, _:RubiNotebookReference["5bf552b0"]] := b^IntPart[p]*(b*(c*Sin[e + f*x])^n)^ FracPart[p]/(c*Sin[e + f*x])^(n*FracPart[p])* Int[ActivateTrig[u]*(c*Sin[e + f*x])^(n*p), x] /; FreeQ[{b, c, e, f, n, p}, x] && Not[IntegerQ[p]] && Not[IntegerQ[n]] && (EqQ[u, 1] || MatchQ[u, (d_.*trig_[e + f*x])^m_. /; FreeQ[{d, m}, x] && MemberQ[{sin, cos, tan, cot, sec, csc}, trig]])
(* Int[(a_+b_.*sin[e_.+f_.*x_]^4)^p_.,x_Symbol] :=  With[{ff=FreeFactors[Tan[e+f*x],x]}, -ff/f*Subst[Int[(a+b+2*a*ff^2*x^2+a*ff^4*x^4)^p/(1+ff^2*x^2)^(2*p+1) ,x],x,Cot[e+f*x]/ff]] /; FreeQ[{a,b,e,f},x] && IntegerQ[p] *)
Int[(a_ + b_.*sin[e_. + f_.*x_]^4)^p_., x_Symbol, _:RubiNotebookReference["587186de"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^ p/(1 + ff^2*x^2)^(2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[p]
Int[(a_ + b_.*sin[e_. + f_.*x_]^4)^p_, x_Symbol, _:RubiNotebookReference["59b3ece9"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(a + b*Sin[e + f*x]^4)^ p*(Sec[e + f*x]^2)^(2* p)/(f*(a + 2*a*Tan[e + f*x]^2 + (a + b)*Tan[e + f*x]^4)^p)* Subst[ Int[(a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^ p/(1 + ff^2*x^2)^(2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[p - 1/2]
Int[1/(a_ + b_.*sin[e_. + f_.*x_]^n_), x_Symbol, _:RubiNotebookReference["5cfcfa6c"]] := Module[{k}, Dist[2/(a*n), Sum[Int[1/(1 - Sin[e + f*x]^2/((-1)^(4*k/n)*Rt[-a/b, n/2])), x], {k, 1, n/2}], x]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[n/2]
(* Int[(a_+b_.*sin[e_.+f_.*x_]^n_)^p_,x_Symbol] :=  With[{ff=FreeFactors[Tan[e+f*x],x]}, -ff/f*Subst[Int[(b+a*(1+ff^2*x^2)^(n/2))^p/(1+ff^2*x^2)^(n*p/2+1),x] ,x,Cot[e+f*x]/ff]] /; FreeQ[{a,b,e,f},x] && IntegerQ[n/2] &&  IGtQ[p,0] *)
Int[(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_, x_Symbol, _:RubiNotebookReference["5f782e02"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(b*ff^n*x^n + a*(1 + ff^2*x^2)^(n/2))^ p/(1 + ff^2*x^2)^(n*p/2 + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[n/2] && IGtQ[p, 0]
Int[(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_, x_Symbol, _:RubiNotebookReference["5eba4435"]] := Int[ExpandTrig[(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, e, f, n}, x] && (IGtQ[p, 0] || EqQ[p, -1] && IntegerQ[n])
Int[(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_, x_Symbol, _:RubiNotebookReference["55e60308"]] := Unintegrable[(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, e, f, n, p}, x]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_., x_Symbol, _:RubiNotebookReference["5424693f"]] := With[{ff = FreeFactors[Cos[e + f*x], x]}, -ff/f* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b - 2*b*ff^2*x^2 + b*ff^4*x^4)^p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol, _:RubiNotebookReference["e34935d5"]] := With[{ff = FreeFactors[Cos[e + f*x], x]}, -ff/f* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*(1 - ff^2*x^2)^(n/2))^ p, x], x, Cos[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_., x_Symbol, _:RubiNotebookReference["e28b5fe2"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[ x^m*(a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^ p/(1 + ff^2*x^2)^(m/2 + 2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol, _:RubiNotebookReference["e0cde1bb"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[ x^m*(a*(1 + ff^2*x^2)^(n/2) + b*ff^n*x^n)^ p/(1 + ff^2*x^2)^(m/2 + n*p/2 + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[n/2] && IntegerQ[p]
Int[sin[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_, x_Symbol, _:RubiNotebookReference["e10f8b8c"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)*(a + b*Sin[e + f*x]^4)^ p*(Sec[e + f*x]^2)^(2*p)/(f* Apart[a*(1 + Tan[e + f*x]^2)^2 + b*Tan[e + f*x]^4]^p)* Subst[ Int[x^m*ExpandToSum[a*(1 + ff^2*x^2)^2 + b*ff^4*x^4, x]^ p/(1 + ff^2*x^2)^(m/2 + 2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[m/2] && IntegerQ[p - 1/2]
Int[sin[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol, _:RubiNotebookReference["e4409d09"]] := Int[ExpandTrig[sin[e + f*x]^m*(a + b*sin[e + f*x]^n)^p, x], x] /; FreeQ[{a, b, e, f}, x] && IntegersQ[m, p] && (EqQ[n, 4] || GtQ[p, 0] || EqQ[p, -1] && IntegerQ[n])
Int[(d_.*sin[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol, _:RubiNotebookReference["e582f73e"]] := Int[ExpandTrig[(d*sin[e + f*x])^m*(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[(d_.*sin[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol, _:RubiNotebookReference["e7c44967"]] := Unintegrable[(d*Sin[e + f*x])^m*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[cos[e_. + f_.*x_]^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_., x_Symbol, _:RubiNotebookReference["e6062350"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff/f* Subst[Int[(1 - ff^2*x^2)^((m - 1)/2)*(a + b*(c*ff*x)^n)^p, x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && IntegerQ[(m - 1)/2] && (EqQ[n, 4] || GtQ[m, 0] || IGtQ[p, 0] || IntegersQ[m, p])
Int[cos[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_., x_Symbol, _:RubiNotebookReference["ed5a646d"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(a + 2*a*ff^2*x^2 + (a + b)*ff^4*x^4)^ p/(1 + ff^2*x^2)^(m/2 + 2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[p]
Int[cos[e_. + f_.*x_]^m_*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol, _:RubiNotebookReference["ec980e5a"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(b*ff^n*x^n + a*(1 + ff^2*x^2)^(n/2))^ p/(1 + ff^2*x^2)^(m/2 + n*p/2 + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, e, f}, x] && IntegerQ[m/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[e_. + f_.*x_]^m_/(a_ + b_.*sin[e_. + f_.*x_]^n_), x_Symbol, _:RubiNotebookReference["f1fc9a3b"]] := Int[Expand[(1 - Sin[e + f*x]^2)^(m/2)/(a + b*Sin[e + f*x]^n), x], x] /; FreeQ[{a, b, e, f}, x] && IGtQ[m/2, 0] && IntegerQ[(n - 1)/2]
(* Int[cos[e_.+f_.*x_]^m_*(a_+b_.*sin[e_.+f_.*x_]^n_)^p_,x_Symbol] :=   Int[ExpandTrig[(1-sin[e+f*x]^2)^(m/2)*(a+b*sin[e+f*x]^n)^p,x],x] /;  FreeQ[{a,b,e,f},x] && IntegerQ[m/2] && IntegerQ[(n-1)/2] &&  ILtQ[p,-1] && LtQ[m,0] *)
Int[(d_.*cos[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol, _:RubiNotebookReference["f2784e55"]] := Int[ExpandTrig[(d*cos[e + f*x])^m*(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[(d_.*cos[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol, _:RubiNotebookReference["f3ba2462"]] := Unintegrable[(d*Cos[e + f*x])^m*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[tan[e_. + f_.*x_]^m_.*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol, _:RubiNotebookReference["f6f532e7"]] := With[{ff = FreeFactors[Sin[e + f*x]^2, x]}, ff^((m + 1)/2)/(2*f)* Subst[Int[ x^((m - 1)/2)*(a + b*ff^(n/2)*x^(n/2))^p/(1 - ff*x)^((m + 1)/2), x], x, Sin[e + f*x]^2/ff]] /; FreeQ[{a, b, e, f, p}, x] && IntegerQ[(m - 1)/2] && IntegerQ[n/2]
Int[tan[e_. + f_.*x_]^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^p_., x_Symbol, _:RubiNotebookReference["f73758d0"]] := With[{ff = FreeFactors[Sin[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[x^m*(a + b*(c*ff*x)^n)^p/(1 - ff^2*x^2)^((m + 1)/2), x], x, Sin[e + f*x]/ff]] /; FreeQ[{a, b, c, e, f, n, p}, x] && ILtQ[(m - 1)/2, 0]
Int[(d_.*tan[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_., x_Symbol, _:RubiNotebookReference["f571e689"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff/f* Subst[Int[(d*ff*x)^m* ExpandToSum[a*(1 + ff^2*x^2)^2 + b*ff^4*x^4, x]^ p/(1 + ff^2*x^2)^(2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[p]
Int[(d_.*tan[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^4)^p_, x_Symbol, _:RubiNotebookReference["f4b38cbe"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff*(a + b*Sin[e + f*x]^4)^ p*(Sec[e + f*x]^2)^(2*p)/(f* Apart[a*(1 + Tan[e + f*x]^2)^2 + b*Tan[e + f*x]^4]^p)* Subst[ Int[(d*ff*x)^m* ExpandToSum[a*(1 + ff^2*x^2)^2 + b*ff^4*x^4, x]^ p/(1 + ff^2*x^2)^(2*p + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[p - 1/2]
Int[(d_.*tan[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^n_)^p_., x_Symbol, _:RubiNotebookReference["ffefcb83"]] := With[{ff = FreeFactors[Tan[e + f*x], x]}, ff^(m + 1)/f* Subst[Int[(d*x)^ m*(b*ff^n*x^n + a*(1 + ff^2*x^2)^(n/2))^ p/(1 + ff^2*x^2)^(n*p/2 + 1), x], x, Tan[e + f*x]/ff]] /; FreeQ[{a, b, d, e, f, m}, x] && IntegerQ[n/2] && IGtQ[p, 0]
Int[(d_.*tan[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol, _:RubiNotebookReference["fe2da1b4"]] := Int[ExpandTrig[(d*tan[e + f*x])^m*(a + b*(c*sin[e + f*x])^n)^p, x], x] /; FreeQ[{a, b, c, d, e, f, m, n}, x] && IGtQ[p, 0]
Int[(d_.*tan[e_. + f_.*x_])^m_.*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_., x_Symbol, _:RubiNotebookReference["4940fd5e"]] := Unintegrable[(d*Tan[e + f*x])^m*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x]
Int[(d_.*cot[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_, x_Symbol, _:RubiNotebookReference["48829769"]] := (d*Cot[e + f*x])^FracPart[m]*(Tan[e + f*x]/d)^ FracPart[m]* Int[(Tan[e + f*x]/d)^(-m)*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[(d_.*sec[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_, x_Symbol, _:RubiNotebookReference["4ac42930"]] := (d*Sec[e + f*x])^FracPart[m]*(Cos[e + f*x]/d)^ FracPart[m]* Int[(Cos[e + f*x]/d)^(-m)*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[(d_.*csc[e_. + f_.*x_])^m_*(a_ + b_.*sin[e_. + f_.*x_]^n_.)^p_., x_Symbol, _:RubiNotebookReference["4b064307"]] := d^(n*p)*Int[(d*Csc[e + f*x])^(m - n*p)*(b + a*Csc[e + f*x]^n)^p, x] /; FreeQ[{a, b, d, e, f, m, n, p}, x] && Not[IntegerQ[m]] && IntegersQ[n, p]
Int[(d_.*csc[e_. + f_.*x_])^m_*(a_ + b_.*(c_.*sin[e_. + f_.*x_])^n_)^ p_, x_Symbol, _:RubiNotebookReference["4e495582"]] := (d*Csc[e + f*x])^FracPart[m]*(Sin[e + f*x]/d)^ FracPart[m]* Int[(Sin[e + f*x]/d)^(-m)*(a + b*(c*Sin[e + f*x])^n)^p, x] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && Not[IntegerQ[m]]
Int[(a_ + b_.*(c_.*sin[e_. + f_.*x_] + d_.*cos[e_. + f_.*x_])^2)^p_, x_Symbol, _:RubiNotebookReference["4f8b3fb5"]] := Int[(a + b*(Sqrt[c^2 + d^2]*Sin[ArcTan[c, d] + e + f*x])^2)^p, x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[p^2, 1/4] && GtQ[a, 0]
Int[(a_ + b_.*(c_.*sin[e_. + f_.*x_] + d_.*cos[e_. + f_.*x_])^2)^p_, x_Symbol, _:RubiNotebookReference["4dcd81ec"]] := (a + b*(c*Sin[e + f*x] + d*Cos[e + f*x])^2)^ p/(1 + (b*(c*Sin[e + f*x] + d*Cos[e + f*x])^2)/a)^p* Int[(1 + (b*(c*Sin[e + f*x] + d*Cos[e + f*x])^2)/a)^p, x] /; FreeQ[{a, b, c, d, e, f}, x] && EqQ[p^2, 1/4] && Not[GtQ[a, 0]]
