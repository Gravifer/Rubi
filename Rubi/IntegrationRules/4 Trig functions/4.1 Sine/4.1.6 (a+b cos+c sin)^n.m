
(* ::Subsection::Closed:: *)
(* 4.1.6 (a+b cos+c sin)^n *)
Int[Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol, _:RubiNotebookReference["46997c72"]] := -2*(c*Cos[d + e*x] - b*Sin[d + e*x])/(e* Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]]) /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0]
Int[(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol, _:RubiNotebookReference["44dfc22b"]] := -(c*Cos[d + e*x] - b*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)/(e*n) + a*(2*n - 1)/n* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0] && GtQ[n, 0]
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["451da81c"]] := -(c - a*Sin[d + e*x])/(c* e*(c*Cos[d + e*x] - b*Sin[d + e*x])) /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0]
Int[1/Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol, _:RubiNotebookReference["4052be99"]] := Int[1/Sqrt[a + Sqrt[b^2 + c^2]*Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0]
Int[(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol, _:RubiNotebookReference["4190d4ae"]] := (c*Cos[d + e*x] - b*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(2*n + 1)) + (n + 1)/(a*(2*n + 1))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a^2 - b^2 - c^2, 0] && LtQ[n, -1]
Int[Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol, _:RubiNotebookReference["43d66af7"]] := b/(c*e)*Subst[Int[Sqrt[a + x]/x, x], x, b*Cos[d + e*x] + c*Sin[d + e*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[b^2 + c^2, 0]
Int[Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol, _:RubiNotebookReference["421400c0"]] := Int[Sqrt[a + Sqrt[b^2 + c^2]*Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 + c^2, 0] && GtQ[a + Sqrt[b^2 + c^2], 0]
Int[Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol, _:RubiNotebookReference["494847fd"]] := Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/ Sqrt[(a + b*Cos[d + e*x] + c*Sin[d + e*x])/(a + Sqrt[b^2 + c^2])]* Int[ Sqrt[a/(a + Sqrt[b^2 + c^2]) + Sqrt[b^2 + c^2]/(a + Sqrt[b^2 + c^2])* Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[b^2 + c^2, 0] && Not[GtQ[a + Sqrt[b^2 + c^2], 0]]
Int[(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol, _:RubiNotebookReference["488a2dca"]] := -(c*Cos[d + e*x] - b*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)/(e*n) + 1/n*Int[ Simp[n*a^2 + (n - 1)*(b^2 + c^2) + a*b*(2*n - 1)*Cos[d + e*x] + a*c*(2*n - 1)*Sin[d + e*x], x]* (a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 2), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && GtQ[n, 1]
(* Int[1/(a_+b_.*cos[d_.+e_.*x_]+c_.*sin[d_.+e_.*x_]),x_Symbol] :=  x/Sqrt[a^2-b^2-c^2] + 2/(e*Sqrt[a^2-b^2-c^2])*ArcTan[(c*Cos[d+e*x]-b*Sin[d+e*x])/(a+Sqrt[ a^2-b^2-c^2]+b*Cos[d+e*x]+c*Sin[d+e*x])] /; FreeQ[{a,b,c,d,e},x] &&  GtQ[a^2-b^2-c^2,0] *)
(* Int[1/(a_+b_.*cos[d_.+e_.*x_]+c_.*sin[d_.+e_.*x_]),x_Symbol] :=  Log[RemoveContent[b^2+c^2+(a*b-c*Rt[-a^2+b^2+c^2,2])*Cos[d+e*x]+(a*c+ b*Sqrt[-a^2+b^2+c^2])*Sin[d+e*x],x]]/ (2*e*Rt[-a^2+b^2+c^2,2]) - Log[RemoveContent[b^2+c^2+(a*b+c*Rt[-a^2+b^2+c^2,2])*Cos[d+e*x]+(a* c-b*Sqrt[-a^2+b^2+c^2])*Sin[d+e*x],x]]/ (2*e*Rt[-a^2+b^2+c^2,2]) /; FreeQ[{a,b,c,d,e},x] &&  LtQ[a^2-b^2-c^2,0] *)
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["3a1ec7b5"]] := Module[{f = FreeFactors[Cot[(d + e*x)/2], x]}, -f/e*Subst[Int[1/(a + c*f*x), x], x, Cot[(d + e*x)/2]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a + b, 0]
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["3bdcad82"]] := Module[{f = FreeFactors[Tan[(d + e*x)/2 + Pi/4], x]}, f/e*Subst[Int[1/(a + b*f*x), x], x, Tan[(d + e*x)/2 + Pi/4]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a + c, 0]
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["3e93bb07"]] := Module[{f = FreeFactors[Cot[(d + e*x)/2 + Pi/4], x]}, -f/e* Subst[Int[1/(a + b*f*x), x], x, Cot[(d + e*x)/2 + Pi/4]/f]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[a - c, 0] && NeQ[a - b, 0]
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["3f51d130"]] := Module[{f = FreeFactors[Tan[(d + e*x)/2], x]}, 2*f/e* Subst[Int[1/(a + b + 2*c*f*x + (a - b)*f^2*x^2), x], x, Tan[(d + e*x)/2]/f]] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0]
Int[1/Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol, _:RubiNotebookReference["3d176f69"]] := b/(c*e)*Subst[Int[1/(x*Sqrt[a + x]), x], x, b*Cos[d + e*x] + c*Sin[d + e*x]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[b^2 + c^2, 0]
Int[1/Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol, _:RubiNotebookReference["3cd5055e"]] := Int[1/Sqrt[a + Sqrt[b^2 + c^2]*Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[b^2 + c^2, 0] && GtQ[a + Sqrt[b^2 + c^2], 0]
Int[1/Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol, _:RubiNotebookReference["37894263"]] := Sqrt[(a + b*Cos[d + e*x] + c*Sin[d + e*x])/(a + Sqrt[b^2 + c^2])]/ Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]]* Int[ 1/Sqrt[a/(a + Sqrt[b^2 + c^2]) + Sqrt[b^2 + c^2]/(a + Sqrt[b^2 + c^2])* Cos[d + e*x - ArcTan[b, c]]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[b^2 + c^2, 0] && Not[GtQ[a + Sqrt[b^2 + c^2], 0]]
Int[1/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^(3/2), x_Symbol, _:RubiNotebookReference["364b2854"]] := 2*(c*Cos[d + e*x] - b*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)* Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]]) + 1/(a^2 - b^2 - c^2)* Int[Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]], x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0]
Int[(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol, _:RubiNotebookReference["2b2fbc35"]] := (-c*Cos[d + e*x] + b*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/(e*(n + 1)*(a^2 - b^2 - c^2)) + 1/((n + 1)*(a^2 - b^2 - c^2))* Int[(a*(n + 1) - b*(n + 2)*Cos[d + e*x] - c*(n + 2)*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1), x] /; FreeQ[{a, b, c, d, e}, x] && NeQ[a^2 - b^2 - c^2, 0] && LtQ[n, -1] && NeQ[n, -3/2]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["2aedd602"]] := (2*a*A - b*B - c*C)* x/(2*a^2) - (b*B + c*C)*(b*Cos[d + e*x] - c*Sin[d + e*x])/(2*a*b*c*e) + (a^2*(b*B - c*C) - 2*a*A*b^2 + b^2*(b*B + c*C))* Log[RemoveContent[a + b*Cos[d + e*x] + c*Sin[d + e*x], x]]/(2*a^2* b*c*e) /; FreeQ[{a, b, c, d, e, A, B, C}, x] && EqQ[b^2 + c^2, 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["28ab685b"]] := (2*a*A - c*C)*x/(2*a^2) - C*Cos[d + e*x]/(2*a*e) + c*C*Sin[d + e*x]/(2*a*b*e) + (-a^2*C + 2*a*c*A + b^2*C)* Log[RemoveContent[a + b*Cos[d + e*x] + c*Sin[d + e*x], x]]/(2*a^2* b*e) /; FreeQ[{a, b, c, d, e, A, C}, x] && EqQ[b^2 + c^2, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])/(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["2969026c"]] := (2*a*A - b*B)*x/(2*a^2) - b*B*Cos[d + e*x]/(2*a*c*e) + B*Sin[d + e*x]/(2*a*e) + (a^2*B - 2*a*b*A + b^2*B)* Log[RemoveContent[a + b*Cos[d + e*x] + c*Sin[d + e*x], x]]/(2*a^2* c*e) /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 + c^2, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["2c2614e9"]] := (b*B + c*C)*x/(b^2 + c^2) + (c*B - b*C)* Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[b^2 + c^2, 0] && EqQ[A*(b^2 + c^2) - a*(b*B + c*C), 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["2de47ede"]] := c*C*x/(b^2 + c^2) - b*C*Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[b^2 + c^2, 0] && EqQ[A*(b^2 + c^2) - a*c*C, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["2fa2c087"]] := b*B*x/(b^2 + c^2) + c*B*Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 + c^2, 0] && EqQ[A*(b^2 + c^2) - a*b*B, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["2e60aab0"]] := (b*B + c*C)*x/(b^2 + c^2) + (c*B - b*C)* Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) + (A*(b^2 + c^2) - a*(b*B + c*C))/(b^2 + c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[b^2 + c^2, 0] && NeQ[A*(b^2 + c^2) - a*(b*B + c*C), 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["253ced8d"]] := c*C*(d + e*x)/(e*(b^2 + c^2)) - b*C*Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) + (A*(b^2 + c^2) - a*c*C)/(b^2 + c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[b^2 + c^2, 0] && NeQ[A*(b^2 + c^2) - a*c*C, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["24fe87ba"]] := b*B*(d + e*x)/(e*(b^2 + c^2)) + c*B*Log[a + b*Cos[d + e*x] + c*Sin[d + e*x]]/(e*(b^2 + c^2)) + (A*(b^2 + c^2) - a*b*B)/(b^2 + c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 + c^2, 0] && NeQ[A*(b^2 + c^2) - a*b*B, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["9393db50"]] := (B*c - b*C - a*C*Cos[d + e*x] + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) /; FreeQ[{a, b, c, d, e, A, B, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && EqQ[(b*B + c*C)*n + a*A*(n + 1), 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["9251b167"]] := -(b*C + a*C*Cos[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) /; FreeQ[{a, b, c, d, e, A, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && EqQ[c*C*n + a*A*(n + 1), 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["90170f3e"]] := (B*c + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) /; FreeQ[{a, b, c, d, e, A, B, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && EqQ[b*B*n + a*A*(n + 1), 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["91d56509"]] := (B*c - b*C - a*C*Cos[d + e*x] + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + ((b*B + c*C)*n + a*A*(n + 1))/(a*(n + 1))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e, A, B, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && NeQ[(b*B + c*C)*n + a*A*(n + 1), 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["949a738c"]] := -(b*C + a*C*Cos[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + (c*C*n + a*A*(n + 1))/(a*(n + 1))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e, A, C, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && NeQ[c*C*n + a*A*(n + 1), 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["955819bb"]] := (B*c + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + (b*B*n + a*A*(n + 1))/(a*(n + 1))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e, A, B, n}, x] && NeQ[n, -1] && EqQ[a^2 - b^2 - c^2, 0] && NeQ[b*B*n + a*A*(n + 1), 0]
Int[(B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])*(b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["971ea7e2"]] := (c*B - b*C)*(b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/(e*(n + 1)*(b^2 + c^2)) /; FreeQ[{b, c, d, e, B, C}, x] && NeQ[n, -1] && NeQ[b^2 + c^2, 0] && EqQ[b*B + c*C, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["96dccdd5"]] := (B*c - b*C - a*C*Cos[d + e*x] + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + 1/(a*(n + 1))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)* Simp[a*(b*B + c*C)*n + a^2*A*(n + 1) + (n*(a^2*B - B*c^2 + b*c*C) + a*b*A*(n + 1))* Cos[d + e*x] + (n*(b*B*c + a^2*C - b^2*C) + a*c*A*(n + 1))* Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && GtQ[n, 0] && NeQ[a^2 - b^2 - c^2, 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["9d808ae8"]] := -(b*C + a*C*Cos[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + 1/(a*(n + 1))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)* Simp[a*c*C*n + a^2*A*(n + 1) + (c*b*C*n + a*b*A*(n + 1))* Cos[d + e*x] + (a^2*C*n - b^2*C*n + a*c*A*(n + 1))* Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, C}, x] && GtQ[n, 0] && NeQ[a^2 - b^2 - c^2, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])*(a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["9c42e0df"]] := (B*c + a*B*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a*e*(n + 1)) + 1/(a*(n + 1))*Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n - 1)* Simp[a*b*B*n + a^2*A*(n + 1) + (a^2*B*n - c^2*B*n + a*b*A*(n + 1))* Cos[d + e*x] + (b*c*B*n + a*c*A*(n + 1))*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && GtQ[n, 0] && NeQ[a^2 - b^2 - c^2, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/ Sqrt[a_ + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_]], x_Symbol, _:RubiNotebookReference["e44e3e9"]] := B/b*Int[Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]], x] + (A*b - a*B)/b* Int[1/Sqrt[a + b*Cos[d + e*x] + c*Sin[d + e*x]], x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && EqQ[B*c - b*C, 0] && NeQ[A*b - a*B, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol, _:RubiNotebookReference["f8689de"]] := (c*B - b*C - (a*C - c*A)*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])/ (e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && EqQ[a*A - b*B - c*C, 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol, _:RubiNotebookReference["dc03787"]] := -(b*C + (a*C - c*A)*Cos[d + e*x] + b*A*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && EqQ[a*A - c*C, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol, _:RubiNotebookReference["c025db0"]] := (c*B + c*A*Cos[d + e*x] + (a*B - b*A)* Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[a^2 - b^2 - c^2, 0] && EqQ[a*A - b*B, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol, _:RubiNotebookReference["94d4b35"]] := (c*B - b*C - (a*C - c*A)*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])/ (e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) + (a*A - b*B - c*C)/(a^2 - b^2 - c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[a*A - b*B - c*C, 0]
Int[(A_. + C_.*sin[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol, _:RubiNotebookReference["88f2102"]] := -(b*C + (a*C - c*A)*Cos[d + e*x] + b*A*Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) + (a*A - c*C)/(a^2 - b^2 - c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, C}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[a*A - c*C, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_])/(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^2, x_Symbol, _:RubiNotebookReference["ac99f5b"]] := (c*B + c*A*Cos[d + e*x] + (a*B - b*A)* Sin[d + e*x])/(e*(a^2 - b^2 - c^2)*(a + b*Cos[d + e*x] + c*Sin[d + e*x])) + (a*A - b*B)/(a^2 - b^2 - c^2)* Int[1/(a + b*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[a*A - b*B, 0]
Int[(A_. + B_.*cos[d_. + e_.*x_] + C_.*sin[d_. + e_.*x_])*(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol, _:RubiNotebookReference["b0bf56c"]] := -(c*B - b*C - (a*C - c*A)*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/ (e*(n + 1)*(a^2 - b^2 - c^2)) + 1/((n + 1)*(a^2 - b^2 - c^2))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)* Simp[(n + 1)*(a*A - b*B - c*C) + (n + 2)*(a*B - b*A)* Cos[d + e*x] + (n + 2)*(a*C - c*A)*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B, C}, x] && LtQ[n, -1] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[n, -2]
Int[(A_. + C_.*sin[d_. + e_.*x_])*(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol, _:RubiNotebookReference["57b251"]] := (b*C + (a*C - c*A)*Cos[d + e*x] + b*A*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/ (e*(n + 1)*(a^2 - b^2 - c^2)) + 1/((n + 1)*(a^2 - b^2 - c^2))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)* Simp[(n + 1)*(a*A - c*C) - (n + 2)*b*A* Cos[d + e*x] + (n + 2)*(a*C - c*A)*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, C}, x] && LtQ[n, -1] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[n, -2]
Int[(A_. + B_.*cos[d_. + e_.*x_])*(a_. + b_.*cos[d_. + e_.*x_] + c_.*sin[d_. + e_.*x_])^n_, x_Symbol, _:RubiNotebookReference["195d866"]] := -(c*B + c*A*Cos[d + e*x] + (a*B - b*A)*Sin[d + e*x])*(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)/ (e*(n + 1)*(a^2 - b^2 - c^2)) + 1/((n + 1)*(a^2 - b^2 - c^2))* Int[(a + b*Cos[d + e*x] + c*Sin[d + e*x])^(n + 1)* Simp[(n + 1)*(a*A - b*B) + (n + 2)*(a*B - b*A)* Cos[d + e*x] - (n + 2)*c*A*Sin[d + e*x], x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && LtQ[n, -1] && NeQ[a^2 - b^2 - c^2, 0] && NeQ[n, -2]
Int[1/(a_. + b_.*sec[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["b6f8848c"]] := Int[Cos[d + e*x]/(b + a*Cos[d + e*x] + c*Sin[d + e*x]), x] /; FreeQ[{a, b, c, d, e}, x]
Int[1/(a_. + b_.*csc[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_]), x_Symbol, _:RubiNotebookReference["b73aeebb"]] := Int[Sin[d + e*x]/(b + a*Sin[d + e*x] + c*Cos[d + e*x]), x] /; FreeQ[{a, b, c, d, e}, x]
Int[cos[d_. + e_.*x_]^ n_.*(a_. + b_.*sec[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["b57c50e2"]] := Int[(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[n]
Int[sin[d_. + e_.*x_]^ n_.*(a_. + b_.*csc[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_])^n_., x_Symbol, _:RubiNotebookReference["b4be3ad5"]] := Int[(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && IntegerQ[n]
Int[cos[d_. + e_.*x_]^ n_*(a_. + b_.*sec[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_])^n_, x_Symbol, _:RubiNotebookReference["b1f12c50"]] := Cos[d + e*x]^ n*(a + b*Sec[d + e*x] + c*Tan[d + e*x])^ n/(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n* Int[(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && Not[IntegerQ[n]]
Int[sin[d_. + e_.*x_]^ n_*(a_. + b_.*csc[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_])^n_, x_Symbol, _:RubiNotebookReference["b0334667"]] := Sin[d + e*x]^ n*(a + b*Csc[d + e*x] + c*Cot[d + e*x])^ n/(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n* Int[(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && Not[IntegerQ[n]]
Int[sec[d_. + e_.*x_]^ n_.*(a_. + b_.*sec[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_])^m_, x_Symbol, _:RubiNotebookReference["b275f83e"]] := Int[1/(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] && IntegerQ[n]
Int[csc[d_. + e_.*x_]^ n_.*(a_. + b_.*csc[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_])^m_, x_Symbol, _:RubiNotebookReference["b3b79209"]] := Int[1/(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] && IntegerQ[n]
Int[sec[d_. + e_.*x_]^ n_.*(a_. + b_.*sec[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_])^m_, x_Symbol, _:RubiNotebookReference["b8ebd534"]] := Sec[d + e*x]^ n*(b + a*Cos[d + e*x] + c*Sin[d + e*x])^ n/(a + b*Sec[d + e*x] + c*Tan[d + e*x])^n* Int[1/(b + a*Cos[d + e*x] + c*Sin[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] && Not[IntegerQ[n]]
Int[csc[d_. + e_.*x_]^ n_.*(a_. + b_.*csc[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_])^m_, x_Symbol, _:RubiNotebookReference["b929bf03"]] := Csc[d + e*x]^ n*(b + a*Sin[d + e*x] + c*Cos[d + e*x])^ n/(a + b*Csc[d + e*x] + c*Cot[d + e*x])^n* Int[1/(b + a*Sin[d + e*x] + c*Cos[d + e*x])^n, x] /; FreeQ[{a, b, c, d, e}, x] && EqQ[m + n, 0] && Not[IntegerQ[n]]
