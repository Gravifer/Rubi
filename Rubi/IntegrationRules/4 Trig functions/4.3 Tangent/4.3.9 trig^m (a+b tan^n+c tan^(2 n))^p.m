
(* ::Subsection::Closed:: *)
(* 4.3.9 trig^m (a+b tan^n+c tan^(2 n))^p *)
Int[(a_ + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_., x_Symbol, _:RubiNotebookReference["bbb3490d"]] := 1/(4^p*c^p)*Int[(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[(a_ + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_., x_Symbol, _:RubiNotebookReference["b9f5f754"]] := 1/(4^p*c^p)*Int[(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[(a_ + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_, x_Symbol, _:RubiNotebookReference["b8379d63"]] := (a + b*Tan[d + e*x]^n + c*Tan[d + e*x]^(2*n))^ p/(b + 2*c*Tan[d + e*x]^n)^(2*p)* Int[(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[(a_ + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_, x_Symbol, _:RubiNotebookReference["bd788be6"]] := (a + b*Cot[d + e*x]^n + c*Cot[d + e*x]^(2*n))^ p/(b + 2*c*Cot[d + e*x]^n)^(2*p)* Int[(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[1/(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.), x_Symbol, _:RubiNotebookReference["bcbae1d1"]] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/(b - q + 2*c*Tan[d + e*x]^n), x] - 2*c/q*Int[1/(b + q + 2*c*Tan[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[1/(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.), x_Symbol, _:RubiNotebookReference["befc5f88"]] := Module[{q = Rt[b^2 - 4*a*c, 2]}, 2*c/q*Int[1/(b - q + 2*c*Cot[d + e*x]^n), x] - 2*c/q*Int[1/(b + q + 2*c*Cot[d + e*x]^n), x]] /; FreeQ[{a, b, c, d, e, n}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[sin[d_. + e_.*x_]^ m_*(a_. + b_.*(f_.*tan[d_. + e_.*x_])^n_. + c_.*(f_.*tan[d_. + e_.*x_])^n2_.)^p_, x_Symbol, _:RubiNotebookReference["bf3e35bf"]] := f/e*Subst[ Int[x^m*(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1), x], x, f*Tan[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[cos[d_. + e_.*x_]^ m_*(a_. + b_.*(f_.*cot[d_. + e_.*x_])^n_. + c_.*(f_.*cot[d_. + e_.*x_])^n2_.)^p_, x_Symbol, _:RubiNotebookReference["b4627282"]] := -f/e* Subst[Int[x^m*(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1), x], x, f*Cot[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[sin[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_., x_Symbol, _:RubiNotebookReference["b5a018b5"]] := Module[{g = FreeFactors[Cos[d + e*x], x]}, -g/e* Subst[Int[(1 - g^2*x^2)^((m - 1)/2)* ExpandToSum[ a*(g*x)^(2*n) + b*(g*x)^n*(1 - g^2*x^2)^(n/2) + c*(1 - g^2*x^2)^n, x]^p/(g*x)^(2*n*p), x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_., x_Symbol, _:RubiNotebookReference["f9dd5543"]] := Module[{g = FreeFactors[Sin[d + e*x], x]}, g/e*Subst[ Int[(1 - g^2*x^2)^((m - 1)/2)* ExpandToSum[ a*(g*x)^(2*n) + b*(g*x)^n*(1 - g^2*x^2)^(n/2) + c*(1 - g^2*x^2)^n, x]^p/(g*x)^(2*n*p), x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[cos[d_. + e_.*x_]^ m_*(a_. + b_.*(f_.*tan[d_. + e_.*x_])^n_. + c_.*(f_.*tan[d_. + e_.*x_])^n2_.)^p_., x_Symbol, _:RubiNotebookReference["f81f3f74"]] := f^(m + 1)/e* Subst[Int[(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1), x], x, f*Tan[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[sin[d_. + e_.*x_]^ m_*(a_. + b_.*(f_.*cot[d_. + e_.*x_])^n_. + c_.*(f_.*cot[d_. + e_.*x_])^n2_.)^p_., x_Symbol, _:RubiNotebookReference["fa59812d"]] := -f^(m + 1)/e* Subst[Int[(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2)^(m/2 + 1), x], x, f*Cot[d + e*x]] /; FreeQ[{a, b, c, d, e, f, n, p}, x] && EqQ[n2, 2*n] && IntegerQ[m/2]
Int[cos[d_. + e_.*x_]^ m_*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^ p_., x_Symbol, _:RubiNotebookReference["fb9beb1a"]] := Module[{g = FreeFactors[Sin[d + e*x], x]}, g/e*Subst[ Int[(1 - g^2*x^2)^((m - 2*n*p - 1)/2)* ExpandToSum[c*x^(2*n) + b*x^n*(1 - x^2)^(n/2) + a*(1 - x^2)^n, x]^p, x], x, Sin[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[sin[d_. + e_.*x_]^ m_*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^ p_., x_Symbol, _:RubiNotebookReference["fed4fd9f"]] := Module[{g = FreeFactors[Cos[d + e*x], x]}, -g/e* Subst[Int[(1 - g^2*x^2)^((m - 2*n*p - 1)/2)* ExpandToSum[c*x^(2*n) + b*x^n*(1 - x^2)^(n/2) + a*(1 - x^2)^n, x]^p, x], x, Cos[d + e*x]/g]] /; FreeQ[{a, b, c, d, e}, x] && EqQ[n2, 2*n] && IntegerQ[(m - 1)/2] && IntegerQ[n/2] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_, x_Symbol, _:RubiNotebookReference["ff1697a8"]] := 1/(4^p*c^p)*Int[Tan[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_, x_Symbol, _:RubiNotebookReference["fd5029f1"]] := 1/(4^p*c^p)*Int[Cot[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_, x_Symbol, _:RubiNotebookReference["fc9243c6"]] := (a + b*Tan[d + e*x]^n + c*Tan[d + e*x]^(2*n))^ p/(b + 2*c*Tan[d + e*x]^n)^(2*p)* Int[Tan[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_, x_Symbol, _:RubiNotebookReference["f7ce04fb"]] := (a + b*Cot[d + e*x]^n + c*Cot[d + e*x]^(2*n))^ p/(b + 2*c*Cot[d + e*x]^n)^(2*p)* Int[Cot[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*(f_.*tan[d_. + e_.*x_])^n_. + c_.*(f_.*tan[d_. + e_.*x_])^n2_.)^p_, x_Symbol, _:RubiNotebookReference["f60c6ecc"]] := f/e*Subst[Int[(x/f)^m*(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2), x], x, f*Tan[d + e*x]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*(f_.*cot[d_. + e_.*x_])^n_. + c_.*(f_.*cot[d_. + e_.*x_])^n2_.)^p_, x_Symbol, _:RubiNotebookReference["eb68faad"]] := -f/e* Subst[Int[(x/f)^m*(a + b*x^n + c*x^(2*n))^p/(f^2 + x^2), x], x, f*Cot[d + e*x]] /; FreeQ[{a, b, c, d, e, f, m, n, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_., x_Symbol, _:RubiNotebookReference["eaaa909a"]] := 1/(4^p*c^p)*Int[Cot[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_., x_Symbol, _:RubiNotebookReference["e8ec2ec3"]] := 1/(4^p*c^p)*Int[Tan[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[p]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_. + c_.*tan[d_. + e_.*x_]^n2_.)^p_, x_Symbol, _:RubiNotebookReference["e92e44f4"]] := (a + b*Tan[d + e*x]^n + c*Tan[d + e*x]^(2*n))^ p/(b + 2*c*Tan[d + e*x]^n)^(2*p)* Int[Cot[d + e*x]^m*(b + 2*c*Tan[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_. + c_.*cot[d_. + e_.*x_]^n2_.)^p_, x_Symbol, _:RubiNotebookReference["ec615271"]] := (a + b*Cot[d + e*x]^n + c*Cot[d + e*x]^(2*n))^ p/(b + 2*c*Cot[d + e*x]^n)^(2*p)* Int[Tan[d + e*x]^m*(b + 2*c*Cot[d + e*x]^n)^(2*p), x] /; FreeQ[{a, b, c, d, e, m, n, p}, x] && EqQ[n2, 2*n] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[p]]
Int[cot[d_. + e_.*x_]^ m_.*(a_. + b_.*tan[d_. + e_.*x_]^n_ + c_.*tan[d_. + e_.*x_]^n2_)^ p_., x_Symbol, _:RubiNotebookReference["eda33846"]] := Module[{g = FreeFactors[Cot[d + e*x], x]}, g/e*Subst[ Int[(g*x)^(m - 2*n*p)*(c + b*(g*x)^n + a*(g*x)^(2*n))^ p/(1 + g^2*x^2), x], x, Cot[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, m, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2]
Int[tan[d_. + e_.*x_]^ m_.*(a_. + b_.*cot[d_. + e_.*x_]^n_ + c_.*cot[d_. + e_.*x_]^n2_)^ p_., x_Symbol, _:RubiNotebookReference["efe5861f"]] := Module[{g = FreeFactors[Tan[d + e*x], x]}, -g/e* Subst[Int[(g*x)^(m - 2*n*p)*(c + b*(g*x)^n + a*(g*x)^(2*n))^ p/(1 + g^2*x^2), x], x, Tan[d + e*x]/g]] /; FreeQ[{a, b, c, d, e, m, p}, x] && EqQ[n2, 2*n] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n/2]
Int[(A_ + B_.*tan[d_. + e_.*x_])*(a_ + b_.*tan[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_]^2)^n_, x_Symbol, _:RubiNotebookReference["ee27ec28"]] := 1/(4^n*c^n)* Int[(A + B*Tan[d + e*x])*(b + 2*c*Tan[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*cot[d_. + e_.*x_])*(a_ + b_.*cot[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_]^2)^n_, x_Symbol, _:RubiNotebookReference["e57bab15"]] := 1/(4^n*c^n)* Int[(A + B*Cot[d + e*x])*(b + 2*c*Cot[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*tan[d_. + e_.*x_])*(a_ + b_.*tan[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_]^2)^n_, x_Symbol, _:RubiNotebookReference["e4b9c122"]] := (a + b*Tan[d + e*x] + c*Tan[d + e*x]^2)^ n/(b + 2*c*Tan[d + e*x])^(2*n)* Int[(A + B*Tan[d + e*x])*(b + 2*c*Tan[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[n]]
Int[(A_ + B_.*cot[d_. + e_.*x_])*(a_ + b_.*cot[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_]^2)^n_, x_Symbol, _:RubiNotebookReference["53d49dc8"]] := (a + b*Cot[d + e*x] + c*Cot[d + e*x]^2)^ n/(b + 2*c*Cot[d + e*x])^(2*n)* Int[(A + B*Cot[d + e*x])*(b + 2*c*Cot[d + e*x])^(2*n), x] /; FreeQ[{a, b, c, d, e, A, B}, x] && EqQ[b^2 - 4*a*c, 0] && Not[IntegerQ[n]]
Int[(A_ + B_.*tan[d_. + e_.*x_])/(a_. + b_.*tan[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_]^2), x_Symbol, _:RubiNotebookReference["5216f7ff"]] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)* Int[1/Simp[b + q + 2*c*Tan[d + e*x], x], x] + (B - (b*B - 2*A*c)/q)* Int[1/Simp[b - q + 2*c*Tan[d + e*x], x], x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_ + B_.*cot[d_. + e_.*x_])/(a_. + b_.*cot[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_]^2), x_Symbol, _:RubiNotebookReference["505049a6"]] := Module[{q = Rt[b^2 - 4*a*c, 2]}, (B + (b*B - 2*A*c)/q)* Int[1/Simp[b + q + 2*c*Cot[d + e*x], x], x] + (B - (b*B - 2*A*c)/q)* Int[1/Simp[b - q + 2*c*Cot[d + e*x], x], x]] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0]
Int[(A_ + B_.*tan[d_. + e_.*x_])*(a_. + b_.*tan[d_. + e_.*x_] + c_.*tan[d_. + e_.*x_]^2)^n_, x_Symbol, _:RubiNotebookReference["51922391"]] := Int[ExpandTrig[(A + B*tan[d + e*x])*(a + b*tan[d + e*x] + c*tan[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]
Int[(A_ + B_.*cot[d_. + e_.*x_])*(a_. + b_.*cot[d_. + e_.*x_] + c_.*cot[d_. + e_.*x_]^2)^n_, x_Symbol, _:RubiNotebookReference["54dd3514"]] := Int[ExpandTrig[(A + B*cot[d + e*x])*(a + b*cot[d + e*x] + c*cot[d + e*x]^2)^n, x], x] /; FreeQ[{a, b, c, d, e, A, B}, x] && NeQ[b^2 - 4*a*c, 0] && IntegerQ[n]
